{% extends 'main/layoutMain.html' %}

{% block title %}–í—Ö–æ–¥ - –ê–≤—Ç–æ—à–∫–æ–ª–∞ –û–Ω–ª–∞–π–Ω{% endblock %}

{% block content %}
    <h1 class="text-center">üîê –í—Ö–æ–¥</h1>
    <div class="row justify-content-center">
        <div class="col-md-4">
            <form method="post">
                {% csrf_token %}
                <div class="mb-3">
                    <label for="username" class="form-label">–í–≤–µ–¥–∏—Ç–µ –ø–æ—á—Ç—É</label>
                    <input type="text" name="username" id="username" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label for="password" class="form-label">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" name="password" id="password" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-dark w-100">–í–æ–π—Ç–∏</button>
            </form>
            <!-- –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö -->
            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-danger mt-3">{{ message }}</div>  <!-- –î–æ–±–∞–≤–∏–ª–∏ –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É -->
                {% endfor %}
            {% endif %}

            <div class="mt-3 text-center">
                <p><a href="{% url 'password_reset_request' %}" class="text-danger">–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</a></p>
                <p>–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="{% url 'register' %}">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</a></p>
            </div>
        </div>
    </div>

    <script>
        let lockoutTime = {{ lockout_time|default:0 }};
        let button = document.querySelector("button[type='submit']");

        function updateTimer() {
            if (lockoutTime > 0) {
                button.disabled = true;
                button.innerText = `–ü–æ–¥–æ–∂–¥–∏—Ç–µ ${lockoutTime} —Å–µ–∫`;
                lockoutTime--;
                setTimeout(updateTimer, 1000);
            } else {
                button.disabled = false;
                button.innerText = "–í–æ–π—Ç–∏";
            }
        }

        if (lockoutTime > 0) {
            updateTimer();
        }
    </script>

{% endblock %}