from django.core.exceptions import ValidationError
import re

def validate_password_complexity(password):
    """
    Проверяет, что пароль соответствует требованиям сложности:
    - Минимум 8 символов.
    - Максимум 20 символов.
    - Минимум одна заглавная буква (латиница или кириллица).
    - Минимум одна строчная буква (латиница или кириллица).
    - Минимум одна цифра.
    - Минимум один специальный символ.
    - Разрешает русские символы.
    - Выводит все ошибки сразу.
    """
    errors = []

    # Проверка длины пароля
    if len(password) < 8:
        errors.append("Пароль должен содержать минимум 8 символов.")
    if len(password) > 20:
        errors.append("Пароль не может быть длиннее 20 символов.")

    # Проверка на наличие хотя бы одной заглавной буквы (латиница или кириллица)
    if not re.search(r'[A-ZА-Я]', password):
        errors.append("Пароль должен содержать минимум одну заглавную букву.")

    # Проверка на наличие хотя бы одной строчной буквы (латиница или кириллица)
    if not re.search(r'[a-zа-я]', password):
        errors.append("Пароль должен содержать минимум одну строчную букву.")

    # Проверка на наличие хотя бы одной цифры
    if not re.search(r'[0-9]', password):
        errors.append("Пароль должен содержать минимум одну цифру.")

    # Проверка на наличие хотя бы одного специального символа
    if not re.search(r'[!@#$%^&*(),.?":{}|<>]', password):
        errors.append("Пароль должен содержать минимум один специальный символ.")

    # Если есть ошибки, выбрасываем их все сразу
    if errors:
        raise ValidationError(errors)